// EFF Diceware Short Wordlist (1296 words)
// https://www.eff.org/dice

export const EFF_SHORT_WORDLIST = [
  'acid', 'acorn', 'acre', 'acts', 'afar', 'affix', 'aged', 'agent', 'agile', 'aging',
  'agony', 'ahead', 'aide', 'aids', 'aim', 'ajar', 'alarm', 'album', 'alert', 'alike',
  'alive', 'alley', 'allot', 'allow', 'ally', 'along', 'amend', 'ample', 'amuse', 'angel',
  'anger', 'angle', 'angry', 'angst', 'ankle', 'antic', 'anvil', 'apart', 'apex', 'aphid',
  'apple', 'April', 'apron', 'aqua', 'area', 'arena', 'argue', 'arise', 'armor', 'army',
  'aroma', 'array', 'arrow', 'arson', 'art', 'ascot', 'ashes', 'aside', 'asked', 'asset',
  'atlas', 'atom', 'attic', 'audio', 'audit', 'avoid', 'award', 'awoke', 'axis', 'bacon',
  'badge', 'badly', 'bagel', 'baggy', 'baked', 'baker', 'balmy', 'banjo', 'barge', 'baron',
  'basic', 'basis', 'batch', 'bath', 'baton', 'blade', 'blame', 'bland', 'blank', 'blast',
  'blaze', 'bleak', 'blend', 'bless', 'blimp', 'blind', 'bliss', 'block', 'blond', 'blood',
  'bloom', 'blown', 'blues', 'blunt', 'blurt', 'blush', 'board', 'boast', 'boat', 'body',
  'bogus', 'boil', 'bold', 'bolt', 'bomb', 'bond', 'bonus', 'book', 'booth', 'boots',
  'boss', 'botch', 'both', 'boxer', 'brace', 'brain', 'brake', 'brand', 'brass', 'brave',
  'bread', 'break', 'breed', 'brew', 'brick', 'bride', 'brief', 'bring', 'brink', 'brisk',
  'broad', 'broil', 'broke', 'brook', 'broom', 'broth', 'brown', 'brush', 'brute', 'buck',
  'buddy', 'budge', 'buggy', 'build', 'built', 'bulge', 'bulk', 'bully', 'bunch', 'bunny',
  'bunt', 'burn', 'burst', 'bury', 'busy', 'buyer', 'cabin', 'cable', 'cache', 'cadet',
  'cage', 'cake', 'calm', 'cameo', 'camp', 'canal', 'candy', 'cane', 'canon', 'cape',
  'card', 'cargo', 'carol', 'carry', 'carve', 'case', 'cash', 'cause', 'cave', 'cease',
  'cedar', 'chain', 'chair', 'chalk', 'champ', 'chant', 'chaos', 'charm', 'chart', 'chase',
  'cheap', 'cheat', 'check', 'cheek', 'cheer', 'chess', 'chest', 'chick', 'chief', 'child',
  'chill', 'chimp', 'china', 'chip', 'chord', 'chore', 'chose', 'chunk', 'churn', 'cider',
  'cigar', 'cinch', 'city', 'civic', 'civil', 'claim', 'clamp', 'clap', 'clash', 'clasp',
  'class', 'claw', 'clay', 'clean', 'clear', 'clerk', 'click', 'cliff', 'climb', 'cling',
  'clip', 'cloak', 'clock', 'clone', 'close', 'cloth', 'cloud', 'clout', 'clown', 'club',
  'cluck', 'clue', 'clump', 'clung', 'coach', 'coast', 'coat', 'cobra', 'cocoa', 'coil',
  'coin', 'coke', 'cola', 'cold', 'colon', 'color', 'comet', 'comic', 'comma', 'cone',
  'coral', 'cord', 'core', 'cork', 'corn', 'cost', 'couch', 'cough', 'count', 'coupe',
  'court', 'cover', 'cozy', 'crack', 'craft', 'cramp', 'crane', 'crank', 'crash', 'crate',
  'crave', 'crawl', 'crazy', 'creak', 'cream', 'cred', 'creek', 'creep', 'creme', 'crepe',
  'crept', 'crest', 'crew', 'crib', 'crick', 'cried', 'crisp', 'crook', 'crop', 'cross',
  'crowd', 'crown', 'crude', 'cruel', 'crush', 'crust', 'cub', 'cult', 'cupid', 'cure',
  'curl', 'curry', 'curse', 'curve', 'cyber', 'cycle', 'daily', 'dairy', 'daisy', 'dance',
  'dandy', 'darts', 'data', 'date', 'dawn', 'deal', 'dealt', 'dean', 'dear', 'death',
  'debit', 'debut', 'decal', 'decay', 'deck', 'decor', 'decoy', 'deed', 'delay', 'delta',
  'deluxe', 'demon', 'denim', 'dense', 'dent', 'depth', 'derby', 'desk', 'dial', 'diary',
  'dice', 'dido', 'dig', 'digit', 'dimly', 'diner', 'disco', 'dish', 'disk', 'ditch',
  'ditto', 'dive', 'dizzy', 'dock', 'dodge', 'doing', 'doll', 'dome', 'donor', 'donut',
  'doom', 'door', 'dorm', 'dose', 'dot', 'doubt', 'dough', 'dove', 'down', 'dozen',
  'draft', 'drain', 'drake', 'drama', 'drank', 'drape', 'draw', 'dread', 'dream', 'dress',
  'drew', 'dried', 'drift', 'drill', 'drink', 'drive', 'droit', 'droll', 'drone', 'drool',
  'drop', 'drove', 'drown', 'drum', 'dry', 'duck', 'duct', 'dude', 'duel', 'duet',
  'dug', 'duke', 'dull', 'dummy', 'dump', 'dune', 'dunk', 'duo', 'dusk', 'dust',
  'duty', 'dwarf', 'dwell', 'dying', 'each', 'eager', 'eagle', 'early', 'earth', 'ease',
  'east', 'eaten', 'eats', 'ebony', 'echo', 'edge', 'edgy', 'edit', 'eel', 'eerie',
  'eight', 'elbow', 'elder', 'elect', 'elite', 'elm', 'elope', 'elude', 'elves', 'email',
  'ember', 'emit', 'empty', 'emu', 'enact', 'end', 'enemy', 'enjoy', 'enter', 'entry',
  'envoy', 'equal', 'equip', 'erase', 'error', 'erupt', 'essay', 'etch', 'evade', 'even',
  'event', 'every', 'evict', 'evil', 'evoke', 'exact', 'exam', 'excel', 'exert', 'exile',
  'exist', 'exit', 'expel', 'extol', 'extra', 'eye', 'fable', 'face', 'facet', 'fact',
  'fade', 'fail', 'faint', 'fair', 'fairy', 'faith', 'fake', 'fall', 'false', 'fame',
  'fancy', 'fang', 'far', 'farce', 'farm', 'fast', 'fatal', 'fate', 'fatty', 'fault',
  'favor', 'feast', 'feat', 'fed', 'feed', 'feel', 'feet', 'feign', 'fell', 'felon',
  'felt', 'femur', 'fence', 'fend', 'fern', 'ferry', 'fest', 'fetch', 'fetal', 'fetch',
  'feud', 'fever', 'few', 'fiber', 'ficus', 'field', 'fifth', 'fifty', 'fight', 'file',
  'fill', 'film', 'filth', 'final', 'finch', 'find', 'fine', 'fire', 'firm', 'first',
  'fish', 'fit', 'five', 'fix', 'flag', 'flair', 'flake', 'flame', 'flank', 'flap',
  'flare', 'flash', 'flask', 'flat', 'flaw', 'flea', 'fled', 'flesh', 'flew', 'flex',
  'flick', 'flier', 'fling', 'flint', 'flip', 'flirt', 'float', 'flock', 'flood', 'floor',
  'flop', 'floss', 'flour', 'flow', 'flown', 'fluid', 'fluke', 'flung', 'flush', 'flute',
  'flux', 'fly', 'foam', 'focal', 'focus', 'fog', 'foil', 'fold', 'folk', 'fond',
  'font', 'food', 'fool', 'foot', 'force', 'forge', 'fork', 'form', 'fort', 'forth',
  'forty', 'forum', 'fossil', 'foster', 'foul', 'found', 'four', 'fox', 'foyer', 'frail',
  'frame', 'frank', 'fraud', 'freak', 'free', 'fresh', 'friar', 'fried', 'frill', 'frisk',
  'from', 'front', 'frost', 'froth', 'frown', 'froze', 'fruit', 'fry', 'fudge', 'fuel',
  'full', 'fully', 'fumes', 'fund', 'fungi', 'funky', 'funny', 'fur', 'fury', 'fuse',
  'fuss', 'fussy', 'fuzzy', 'gag', 'gain', 'gala', 'game', 'gamma', 'gap', 'garage',
  'gas', 'gasp', 'gate', 'gauge', 'gave', 'gawk', 'gaze', 'gear', 'geek', 'gem',
  'gene', 'genie', 'genre', 'ghost', 'giant', 'gift', 'gig', 'gild', 'gills', 'gimp',
  'gist', 'give', 'given', 'glad', 'gland', 'glare', 'glass', 'gleam', 'glee', 'glide',
  'glint', 'gloat', 'globe', 'gloom', 'glory', 'gloss', 'glove', 'glow', 'glue', 'glum',
  'goal', 'goat', 'going', 'gold', 'golf', 'gone', 'gong', 'good', 'goofy', 'goose',
  'gorge', 'gory', 'gown', 'grab', 'grace', 'grade', 'grain', 'grand', 'grant', 'grape',
  'graph', 'grasp', 'grass', 'grave', 'gravy', 'gray', 'graze', 'great', 'greed', 'greek',
  'green', 'greet', 'grew', 'grey', 'grief', 'grill', 'grim', 'grin', 'grind', 'grip',
  'grit', 'groan', 'groom', 'grope', 'gross', 'group', 'grove', 'growl', 'grown', 'grub',
  'grump', 'grunt', 'guard', 'guess', 'guest', 'guide', 'guild', 'guilt', 'guise', 'gulf',
  'gulp', 'gum', 'gun', 'gunk', 'guru', 'gust', 'gut', 'guy', 'habit', 'hack',
  'had', 'hail', 'hair', 'half', 'hall', 'halt', 'hand', 'hang', 'happy', 'hardy',
  'hare', 'harm', 'harsh', 'hash', 'haste', 'hasty', 'hatch', 'hate', 'haul', 'haunt',
  'have', 'haven', 'havoc', 'hawk', 'hay', 'haze', 'hazy', 'head', 'heal', 'heap',
  'heart', 'heat', 'heavy', 'hedge', 'heel', 'hefty', 'held', 'helix', 'hello', 'help',
  'hemp', 'hence', 'herb', 'herd', 'here', 'hero', 'hers', 'hex', 'hide', 'high',
  'hike', 'hill', 'hilt', 'hind', 'hinge', 'hint', 'hip', 'hippo', 'hire', 'hiss',
  'hit', 'hitch', 'hive', 'hoax', 'hobby', 'hog', 'hoist', 'hold', 'hole', 'home',
  'honey', 'honor', 'hood', 'hoof', 'hook', 'hope', 'horde', 'horn', 'horse', 'host',
  'hotel', 'hound', 'hour', 'house', 'howl', 'hub', 'hue', 'hug', 'huge', 'hull',
  'human', 'humid', 'humor', 'hump', 'hunch', 'hung', 'hunk', 'hunt', 'hurry', 'hurt',
  'hush', 'husk', 'husky', 'hut', 'hydro', 'hyena', 'hymn', 'hype', 'ice', 'icing',
  'icon', 'icy', 'ideal', 'idiom', 'idiot', 'idle', 'idly', 'idol', 'igloo', 'ill',
  'image', 'imp', 'imply', 'inch', 'index', 'indie', 'inner', 'input', 'ion', 'iris',
  'iron', 'issue', 'itch', 'item', 'ivory', 'ivy', 'jab', 'jack', 'jade', 'jaded',
  'jail', 'jam', 'jammed', 'jar', 'java', 'jaw', 'jazz', 'jazzy', 'jeans', 'jeep',
  'jelly', 'jerk', 'jest', 'jet', 'jewel', 'jiffy', 'jig', 'jilt', 'job', 'jock',
  'jog', 'join', 'joint', 'joke', 'joker', 'jolly', 'jolt', 'jot', 'joy', 'judge',
  'juice', 'juicy', 'jumbo', 'jump', 'jumpy', 'June', 'junk', 'junky', 'jury', 'just',
  'keg', 'kept', 'key', 'kick', 'kid', 'kidney', 'kill', 'kilt', 'kin', 'kind',
  'king', 'kiosk', 'kiss', 'kite', 'kitty', 'kiwi', 'knee', 'kneel', 'knew', 'knife',
  'knit', 'knock', 'knot', 'know', 'known', 'koala', 'label', 'labor', 'lace', 'lack',
  'lad', 'laden', 'ladle', 'lady', 'lag', 'lair', 'lake', 'lamb', 'lame', 'lamp',
  'lance', 'land', 'lane', 'lap', 'lapse', 'large', 'laser', 'lash', 'last', 'late',
  'latex', 'laugh', 'lava', 'law', 'lawn', 'lay', 'layer', 'lazy', 'lead', 'leaf',
  'leak', 'lean', 'leap', 'learn', 'lease', 'least', 'leave', 'led', 'ledge', 'left',
  'leg', 'legal', 'lemon', 'lend', 'lens', 'lent', 'less', 'level', 'lever', 'lid',
  'life', 'lift', 'light', 'lilac', 'limb', 'lime', 'limit', 'limp', 'line', 'liner',
  'linen', 'link', 'lion', 'lip', 'list', 'lit', 'liver', 'living', 'load', 'loaf',
  'loan', 'lobby', 'local', 'lock', 'lodge', 'loft', 'log', 'logic', 'lone', 'long',
  'look', 'loom', 'loop', 'loose', 'loot', 'lord', 'lose', 'loss', 'lost', 'lot',
  'lotus', 'loud', 'love', 'lover', 'low', 'lower', 'loyal', 'luck', 'lucky', 'lug',
  'lump', 'lunar', 'lunch', 'lung', 'lure', 'lurk', 'lush', 'lust', 'lying', 'lyric',
];

// Separator options for passphrases
export const SEPARATORS = ['-', '_', '.', ' ', ''];

export type PassphraseSeparator = typeof SEPARATORS[number];

/**
 * Generate a secure random integer in range [0, max)
 */
function secureRandomInt(max: number): number {
  const array = new Uint32Array(1);
  crypto.getRandomValues(array);
  return array[0] % max;
}

/**
 * Generate a passphrase from the wordlist
 */
export function generatePassphrase(
  wordCount: number = 5,
  separator: PassphraseSeparator = '-',
  capitalize: boolean = true,
  includeNumber: boolean = true
): string {
  const words: string[] = [];

  for (let i = 0; i < wordCount; i++) {
    let word = EFF_SHORT_WORDLIST[secureRandomInt(EFF_SHORT_WORDLIST.length)];
    if (capitalize) {
      word = word.charAt(0).toUpperCase() + word.slice(1);
    }
    words.push(word);
  }

  let passphrase = words.join(separator);

  if (includeNumber) {
    const num = secureRandomInt(100);
    passphrase += separator + num;
  }

  return passphrase;
}

/**
 * Calculate entropy of a passphrase
 * Entropy = log2(possibilities)
 */
export function calculatePassphraseEntropy(
  wordCount: number,
  wordlistSize: number = EFF_SHORT_WORDLIST.length,
  includeNumber: boolean = true
): number {
  // Each word adds log2(wordlistSize) bits
  let entropy = wordCount * Math.log2(wordlistSize);

  // Adding a number 0-99 adds log2(100) bits
  if (includeNumber) {
    entropy += Math.log2(100);
  }

  return Math.round(entropy);
}

/**
 * Estimate time to crack based on entropy and guesses per second
 */
export function estimateCrackTime(entropy: number, guessesPerSecond: number = 1e12): string {
  const seconds = Math.pow(2, entropy) / guessesPerSecond;

  if (seconds < 60) return `${Math.round(seconds)} seconds`;
  if (seconds < 3600) return `${Math.round(seconds / 60)} minutes`;
  if (seconds < 86400) return `${Math.round(seconds / 3600)} hours`;
  if (seconds < 31536000) return `${Math.round(seconds / 86400)} days`;
  if (seconds < 31536000 * 100) return `${Math.round(seconds / 31536000)} years`;
  if (seconds < 31536000 * 1000000) return `${Math.round(seconds / 31536000 / 1000)} thousand years`;
  if (seconds < 31536000 * 1000000000) return `${Math.round(seconds / 31536000 / 1000000)} million years`;
  return `${(seconds / 31536000 / 1000000000).toExponential(2)} billion years`;
}
